version: "3"

services:
#  redis:
#    image: redis:latest
#    container_name: redis
#    build: deploy
#    volumes:
#      - ./deploy/redis/:/redis/data
#    ports:
#      - 6379:6379
#    restart: always
#    networks:
#      - backend
  redis:
    image: redis:5.0
    environment:
      - TZ=${TZ}
    volumes:
      - ./deploy/redis//redis:/data
    ports:
      - 6379:6379
    networks:
      - backend
    restart: always

  redis-manage:
    image: erikdubbelboer/phpredisadmin:latest
    environment:
      - TZ=${TZ}
      - ADMIN_USER=${REDIS_MANAGE_USERNAME}
      - ADMIN_PASS=${REDIS_MANAGE_PASSWORD}
      - REDIS_1_HOST=${REDIS_MANAGE_CONNECT_HOST}     # 设置连接的 Redis 服务 host，可以是 Redis 服务容器的名称，也可以是 Redis 服务容器的 ip 地址
      - REDIS_1_PORT=${REDIS_MANAGE_CONNECT_PORT}     # 设置连接的 Redis 服务端口号
    ports:
      - "${REDIS_MANAGE_PORT}:80"
    depends_on:
      - redis
    networks:
      - backend
    restart: always

networks:
  backend:
    driver: ${NETWORKS_DRIVER}